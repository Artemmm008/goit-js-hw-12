{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"53393653-1acdc9704f6308d207f4a2045\"; \nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function getImagesByQuery(query, page = 1) {\n    \n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: page,\n    };\n\n    const response = await axios.get(BASE_URL, { params })   \n\n    return response.data;   \n\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\")\nconst loaderOverlay = document.getElementById(\"loader-overlay\"); \nconst loadButton = document.getElementById(\"load-button\")\n\nfunction createMarkup(image) {\n    return `\n        <li class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\" class=\"gallery-link\"> \n                <img src=\"${image.webformatURL}\" \n                     alt=\"${image.tags}\" \n                     class=\"gallery-image\">\n            </a>\n        <div class=\"info\">\n            <p class=\"info-item\"><b>Likes</b>${image.likes}</p>\n            <p class=\"info-item\"><b>Views</b>${image.views}</p>\n            <p class=\"info-item\"><b>Comments</b>${image.comments}</p>\n            <p class=\"info-item\"><b>Downloads</b>${image.downloads}</p>\n        </div>\n    </li>\n    `;\n}\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: 'alt', \n    captionDelay: 250,\n});\n\n\nexport function createGallery(images) {\n    const markup = images.map(createMarkup).join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n}\n\n\nexport function clearGallery() {\n    gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n    if (loaderOverlay) {\n        loaderOverlay.classList.remove('hidden');\n    }\n}\n\nexport function hideLoader() {\n    if (loaderOverlay) {\n        loaderOverlay.classList.add('hidden');\n    }\n}\n\nexport function showLoadMoreButton() {\n    if (loadButton) {\n        loadButton.classList.remove('hidden');\n    }\n}\n\nexport function hideLoadMoreButton() {\n    if (loadButton) {\n        loadButton.classList.add('hidden');\n    }\n}","import { getImagesByQuery } from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalPages = 0;\nconst perPage = 15; \n\nconst form = document.querySelector(\".form\");\nconst input = form.elements.query;\nconst loadButton = document.getElementById(\"load-button\"); \nconst gallery = document.querySelector(\".gallery\");\n\nhideLoader();\nhideLoadMoreButton();\n\nform.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n\n    const query = input.value.trim();\n\n    if (!query) {\n        iziToast.warning({\n            message: \"Please enter a search term!\",\n            position: \"topRight\",\n        });\n        return;\n    }\n\n    currentPage = 1;\n    currentQuery = query;\n\n    hideLoadMoreButton();\n    clearGallery();\n    showLoader();\n    \n    const data = await fetchImages(true);\n\n    if (data && data.hits.length === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\",\n            });\n         \n        hideLoader();\n        form.reset();\n        return;\n    }\n\n    form.reset();\n\n});\n\nloadButton.addEventListener(\"click\", async () => {\n\n    currentPage += 1;\n\n    hideLoadMoreButton();\n    showLoader();\n\n    const data = await fetchImages(false);\n\n    if (data && data.hits.length > 0) {\n        smoothScroll();\n    }\n    \n\n})\n\nasync function fetchImages(isFirstSearch) {\n\ntry {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    const hits = data.hits; \n    const totalHits = data.totalHits;\n    totalPages = Math.ceil(totalHits / perPage);\n\nif (!hits.length) {\n        hideLoadMoreButton();\n        if (isFirstSearch) {\n            return data;\n        }\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: \"bottomCenter\",\n        });\n        return data;\n    }\n\n    createGallery(hits);\n\n    if (currentPage < totalPages) {\n        showLoadMoreButton();\n    } else {\n        hideLoadMoreButton();\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: \"bottomCenter\",\n        });\n    }\n\n    return data\n}\n    \ncatch(error) {\niziToast.error({\n            message: \"Error\",\n            position: \"topRight\",\n        });\n        console.error(error);\n}\n\nfinally {\n        hideLoader();\n    }\n    \n}\n\nfunction smoothScroll() {\n    const firstGalleryItem = gallery.querySelector('.gallery-item');\n\n    if (firstGalleryItem) {\n\n        const { height: cardHeight } = firstGalleryItem.getBoundingClientRect();\n        \n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n        });\n    }\n}"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","params","axios","gallery","loaderOverlay","loadButton","createMarkup","image","lightbox","SimpleLightbox","createGallery","images","markup","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","currentPage","currentQuery","totalPages","perPage","form","input","iziToast","data","fetchImages","smoothScroll","isFirstSearch","hits","totalHits","error","firstGalleryItem","cardHeight"],"mappings":"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"}